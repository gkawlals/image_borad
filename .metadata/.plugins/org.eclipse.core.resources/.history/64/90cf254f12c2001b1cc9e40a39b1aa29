<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<%@page import="java.util.List"%>
<%@page import="java.util.ArrayList"%>
<%@page import="poly.dto.ImageDTO"%>
<%@page import="poly.dto.UserDTO"%>
<%@page import="poly.util.CmmUtil"%>
<%
	List<ImageDTO> rList = (List<ImageDTO>) request.getAttribute("rList");

	if( rList == null){
		rList = new ArrayList<ImageDTO>();
	}
	
	String SS_USER_ID = CmmUtil.nvl((String)session.getAttribute("SS_USER_ID"));
	
	int imageCnt = 0;
%>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

    <!-- Facebook Meta Tags / 페이스북 오픈 그래프 -->
    <meta property="og:url" content="http://kindtiger.dothome.co.kr/insta">
    <meta property="og:type" content="website">
    <meta property="og:title" content="instagram">
    <meta property="og:description" content="instagram clone">
    <meta property="og:image" content="http://kindtiger.dothome.co.kr/insta/imgs/instagram.jpeg">
    .
    <!-- Twitter Meta Tags / 트위터 -->
    <meta name="twitter:card" content="instagram clone">
    <meta name="twitter:title" content="instagram">
    <meta name="twitter:description" content="instagram clone">
    <meta name="twitter:image" content="http://kindtiger.dothome.co.kr/insta/imgs/instagram.jpeg">

    <!-- Google / Search Engine Tags / 구글 검색 엔진 -->
    <meta itemprop="name" content="instagram">
    <meta itemprop="description" content="instagram clone">
    <meta itemprop="image" content="http://kindtiger.dothome.co.kr/insta/imgs/instagram.jpeg">
    <title>instagram</title>
    <link rel="stylesheet" href="../resourceImg/css/reset.css">
    <link rel="stylesheet" href="../resourceImg/css/common.css">
    <link rel="stylesheet" href="../resourceImg/css/style.css">
    <link rel="stylesheet" href="../resourceImg/css/profile.css">
    <link rel="shortcut icon" href="../resourceImg/imgs/instagram.png">
</head>
<body>
<section id="container">
    <header id="header">
        <section class="h_inner">

            <h1 class="logo">
                <a href="index.html">
                    <div class="sprite_insta_icon"></div>
                    <div>
                        <div class="sprite_write_logo"></div>
                    </div>
                </a>
            </h1>

            <div class="search_field">
                <input type="text" placeholder="검색" tabindex="0">

                <div class="fake_field">
                    <span class=sprite_small_search_icon></span>
                    <span>검색</span>
                </div>
            </div>

            <div class="right_icons">
                <a href="login.html"><div class="sprite_compass_icon"></div></a>
                <a href="profile.html"><div class="sprite_user_icon_outline"></div></a>
            </div>
            
        </section>
    </header>


    <div id="main_container">

        <section class="b_inner">

            <div class="hori_cont">
                <div class="profile_wrap">
                    <div class="profile_img">
                        <img src="../resourceImg/imgs/thumb.jpeg" alt="착한호랑이">
                    </div>
                </div>

                <div class="detail">
                    <div class="top">
                        <div class="user_name"><%=SS_USER_ID %></div>
                        <a href="profile_edit.html" class="profile_edit">프로필편집</a>
                        <a href="#" class="logout">로그아웃</a>
                    </div>

                    <ul class="middle">
                        <li>
                            <span>게시물</span>
                            <% for(int i = 0; i <= rList.size(); i++){ 
                            	
                            	imageCnt += i; 
                            
                            } %>
                            <%=imageCnt %>
                        </li>
                    </ul>
                    <p class="about">
                        <span class="nick_name">kindtigerrr</span>
                    </p>

                </div>
                
            </div>

            <div class="mylist_contents contents_container active">
                <%
			        for (ImageDTO myList : rList){
    			%>
            	<div class="pic" name="image_no" style="display:none" value="<%=myList.getImage_no()%>">
            		<a onclick="location.href='../image/imageDetail'">
            			<img src="../resourceImg/Image/<%=myList.getSave_folder_name()%>/<%=myList.getSave_file_name()%>" name="user_profile">
            		</a>
            	</div>
            	<%} %>
            </div>
            <div class="bookmark_contents contents_container">
			<!-- 북마커 기준 게시글들 불러오기  -->
            </div>
       </section>
    </div>
</section>
<script>
	function loadUserImg(){
		var img_no = $('#img_no').val();
		
		var pagePath = '../image/imageDetail';
		
		if($('#img_no').val() == ""){
			$('#img_no').focus();
		}
		
		console.log("img_no : " + img_no);
		
		$.ajax({
			usl : '/image/loadUserImg.do',
			type : 'post',
			data : {
				"img_no" : img_no
			},
			success : function(data) {
				console.log("test");
				console.log(data);
				
				var resHTML = '';
				resHTML += '<div class="pic" name="image_no" style="display:none" value="' + data.getImage_no() + '">';
				resHTML += '<a onclick="location.href=' + pagePath +'">';
				resHTML += '<img src="../resourceImg/Image/'+data.getSave_folder_name()+'/'+ data.getSave_file_name() + '" name="user_profile">';
				resHTML += '</a></div';
				if( data.length == 0){
					resHTML += '<div class="pic" name="image_no" style="display:none" value="">';
					resHTML += '<a onclick="location.href=' + pagePath + '">';
					resHTML += '<img src="../resourceImg/Imgs/thumb.jpeg" name=""/>';
					resHTML += '</a></div';
					
				} else {
					for(var i = 0; i < data.length; i++){
						
						resHTML += '<div class="pic" name="image_no" style="display:none" value="' + data.getImage_no() +'">';
						resHTML += '<a onclick="location.href=' + pagePath + '">';
						resHTML += '<img src="../resourceImg/Image/'+data.getSave_folder_name()+'/'+ data.getSave_file_name() + '" name="user_profile">';
						resHTML += '</a></div';
						
					}
					$('#mylist_contents contents_container active').html(resHTML);
					
				}
				
			}
		})
	}
</script>
</body>
</html>